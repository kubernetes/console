{"ast":null,"code":"// Copyright 2017 The Kubernetes Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { switchMap } from 'rxjs/operators';\nimport { AlertDialog } from '@common/dialogs/alert/dialog';\nimport { CsrfTokenService } from '@common/services/global/csrftoken';\nimport { CONFIG_DI_TOKEN } from '../../../../index.config';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@common/services/global/csrftoken\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../helpsection/component\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"../helpsection/userhelp/component\";\nimport * as i10 from \"@angular/material/button\";\n\nfunction CreateSecretDialog_mat_error_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵi18n(1, 20);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CreateSecretDialog_mat_error_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵi18n(1, 21);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵi18nExp(ctx_r1.secretNameMaxLength);\n    i0.ɵɵi18nApply(1);\n  }\n}\n\nfunction CreateSecretDialog_mat_error_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵi18n(1, 22);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CreateSecretDialog_mat_error_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵi18n(1, 23);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CreateSecretDialog_mat_error_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵi18n(1, 24);\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let CreateSecretDialog = /*#__PURE__*/(() => {\n  class CreateSecretDialog {\n    constructor(dialogRef, data_, http_, csrfToken_, matDialog_, fb_, appConfig_) {\n      this.dialogRef = dialogRef;\n      this.data_ = data_;\n      this.http_ = http_;\n      this.csrfToken_ = csrfToken_;\n      this.matDialog_ = matDialog_;\n      this.fb_ = fb_;\n      this.appConfig_ = appConfig_;\n      /**\n       * Max-length validation rule for secretName.\n       */\n\n      this.secretNameMaxLength = 253;\n      /**\n       * Pattern validation rule for secretName.\n       */\n\n      this.secretNamePattern = new RegExp('^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$');\n      /**\n       * Pattern validating if the secret data is Base64 encoded.\n       */\n\n      this.dataPattern = new RegExp('^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$');\n    }\n\n    ngOnInit() {\n      this.form = this.fb_.group({\n        secretName: ['', Validators.compose([Validators.maxLength(this.secretNameMaxLength), Validators.pattern(this.secretNamePattern)])],\n        data: ['', Validators.pattern(this.dataPattern)]\n      });\n    }\n\n    get secretName() {\n      return this.form.get('secretName');\n    }\n\n    get data() {\n      return this.form.get('data');\n    }\n    /**\n     * Creates new secret based on the state of the controller.\n     */\n\n\n    createSecret() {\n      if (!this.form.valid) return;\n      const secretSpec = {\n        name: this.secretName.value,\n        namespace: this.data_.namespace,\n        data: this.data.value\n      };\n      const tokenPromise = this.csrfToken_.getTokenForAction('secret');\n      tokenPromise.pipe(switchMap(csrfToken => this.http_.post('api/v1/secret/', { ...secretSpec\n      }, {\n        headers: new HttpHeaders().set(this.appConfig_.csrfHeaderName, csrfToken.token)\n      }))).subscribe(() => {\n        this.dialogRef.close(this.secretName.value);\n      }, error => {\n        this.dialogRef.close();\n        const configData = {\n          title: 'Error creating secret',\n          message: error.data,\n          confirmLabel: 'OK'\n        };\n        this.matDialog_.open(AlertDialog, {\n          data: configData\n        });\n      });\n    }\n    /**\n     * Cancels the create secret form.\n     */\n\n\n    cancel() {\n      this.dialogRef.close();\n    }\n\n  }\n\n  CreateSecretDialog.ɵfac = function CreateSecretDialog_Factory(t) {\n    return new (t || CreateSecretDialog)(i0.ɵɵdirectiveInject(i1.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.CsrfTokenService), i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(CONFIG_DI_TOKEN));\n  };\n\n  CreateSecretDialog.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CreateSecretDialog,\n    selectors: [[\"kd-create-secret-dialog\"]],\n    decls: 39,\n    vars: 8,\n    consts: function () {\n      let i18n_0;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_6024052576355726934$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_1 = goog.getMsg(\"Create a new image pull secret\");\n        i18n_0 = MSG_EXTERNAL_6024052576355726934$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_1;\n      } else {\n        i18n_0 = $localize`Create a new image pull secret`;\n      }\n\n      let i18n_2;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_6194056995548896650$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_3 = goog.getMsg(\"The new secret will be added to the cluster\");\n        i18n_2 = MSG_EXTERNAL_6194056995548896650$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_3;\n      } else {\n        i18n_2 = $localize`The new secret will be added to the cluster`;\n      }\n\n      let i18n_4;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_5818955156850908956$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_5 = goog.getMsg(\"Secret name\");\n        i18n_4 = MSG_EXTERNAL_5818955156850908956$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_5;\n      } else {\n        i18n_4 = $localize`Secret name`;\n      }\n\n      let i18n_6;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_1832995043073719610$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_7 = goog.getMsg(\"A secret with the specified name will be added to the cluster in the namespace.\");\n        i18n_6 = MSG_EXTERNAL_1832995043073719610$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_7;\n      } else {\n        i18n_6 = $localize`A secret with the specified name will be added to the cluster in the namespace.`;\n      }\n\n      let i18n_8;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_33821194240460925$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_9 = goog.getMsg(\" Learn more {$startItalicText}open_in_new{$closeItalicText}\", {\n          \"startItalicText\": \"\\uFFFD#21\\uFFFD\",\n          \"closeItalicText\": \"\\uFFFD/#21\\uFFFD\"\n        });\n        i18n_8 = MSG_EXTERNAL_33821194240460925$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_9;\n      } else {\n        i18n_8 = $localize` Learn more ${\"\\uFFFD#21\\uFFFD\"}:START_ITALIC_TEXT:open_in_new${\"\\uFFFD/#21\\uFFFD\"}:CLOSE_ITALIC_TEXT:`;\n      }\n\n      let i18n_10;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_7624297849860603812$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_11 = goog.getMsg(\"Specify the data for your secret to hold. The value is the Base64 encoded content of a .dockercfg file.\");\n        i18n_10 = MSG_EXTERNAL_7624297849860603812$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_11;\n      } else {\n        i18n_10 = $localize`Specify the data for your secret to hold. The value is the Base64 encoded content of a .dockercfg file.`;\n      }\n\n      let i18n_12;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_33821194240460925$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_13 = goog.getMsg(\" Learn more {$startItalicText}open_in_new{$closeItalicText}\", {\n          \"startItalicText\": \"\\uFFFD#32\\uFFFD\",\n          \"closeItalicText\": \"\\uFFFD/#32\\uFFFD\"\n        });\n        i18n_12 = MSG_EXTERNAL_33821194240460925$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_13;\n      } else {\n        i18n_12 = $localize` Learn more ${\"\\uFFFD#32\\uFFFD\"}:START_ITALIC_TEXT:open_in_new${\"\\uFFFD/#32\\uFFFD\"}:CLOSE_ITALIC_TEXT:`;\n      }\n\n      let i18n_14;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_5674286808255988565$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_15 = goog.getMsg(\"Create\");\n        i18n_14 = MSG_EXTERNAL_5674286808255988565$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_15;\n      } else {\n        i18n_14 = $localize`Create`;\n      }\n\n      let i18n_16;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_2159130950882492111$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_17 = goog.getMsg(\"Cancel\");\n        i18n_16 = MSG_EXTERNAL_2159130950882492111$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS_17;\n      } else {\n        i18n_16 = $localize`Cancel`;\n      }\n\n      let i18n_18;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_4882930782066600379$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__19 = goog.getMsg(\" Name is required. \");\n        i18n_18 = MSG_EXTERNAL_4882930782066600379$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__19;\n      } else {\n        i18n_18 = $localize` Name is required. `;\n      }\n\n      let i18n_20;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_3556038648013245822$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__21 = goog.getMsg(\" Name must be up to {$interpolation} characters long. \", {\n          \"interpolation\": \"\\uFFFD0\\uFFFD\"\n        });\n        i18n_20 = MSG_EXTERNAL_3556038648013245822$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__21;\n      } else {\n        i18n_20 = $localize` Name must be up to ${\"\\uFFFD0\\uFFFD\"}:INTERPOLATION: characters long. `;\n      }\n\n      let i18n_22;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_3306248973136597457$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__23 = goog.getMsg(\" Name must follow the DNS domain name syntax (e.g. new.image-pull.secret). \");\n        i18n_22 = MSG_EXTERNAL_3306248973136597457$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__23;\n      } else {\n        i18n_22 = $localize` Name must follow the DNS domain name syntax (e.g. new.image-pull.secret). `;\n      }\n\n      let i18n_24;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_6903404509568372284$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__25 = goog.getMsg(\" Data is required. \");\n        i18n_24 = MSG_EXTERNAL_6903404509568372284$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__25;\n      } else {\n        i18n_24 = $localize` Data is required. `;\n      }\n\n      let i18n_26;\n\n      if (typeof ngI18nClosureMode !== \"undefined\" && ngI18nClosureMode) {\n        const MSG_EXTERNAL_3499807200985838911$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__27 = goog.getMsg(\" Data must be Base64 encoded. \");\n        i18n_26 = MSG_EXTERNAL_3499807200985838911$$SRC_APP_FRONTEND_CREATE_FROM_FORM_CREATESECRET_DIALOG_TS__27;\n      } else {\n        i18n_26 = $localize` Data must be Base64 encoded. `;\n      }\n\n      return [[\"mat-dialog-title\", \"\"], i18n_0, [1, \"kd-dialog-text\"], i18n_2, [3, \"formGroup\"], [\"matInput\", \"\", \"type\", \"text\", \"placeholder\", i18n_4, \"name\", \"secretName\", \"formControlName\", \"secretName\", \"required\", \"\"], [\"align\", \"end\"], [4, \"ngIf\"], i18n_6, [\"href\", \"https://kubernetes.io/docs/user-guide/secrets/\", \"target\", \"_blank\", \"tabindex\", \"-1\"], i18n_8, [1, \"material-icons\"], [\"matInput\", \"\", \"type\", \"text\", \"placeholder\", \"Image pull secret data\", \"name\", \"data\", \"formControlName\", \"data\", \"required\", \"\"], i18n_10, [\"href\", \"http://kubernetes.io/docs/user-guide/images/#specifying-imagepullsecrets-on-a-pod\", \"target\", \"_blank\", \"tabindex\", \"-1\"], i18n_12, [\"mat-button\", \"\", \"type\", \"submit\", \"color\", \"primary\", 3, \"click\"], i18n_14, [\"mat-button\", \"\", 3, \"click\"], i18n_16, i18n_18, i18n_20, i18n_22, i18n_24, i18n_26];\n    },\n    template: function CreateSecretDialog_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h4\", 0);\n        i0.ɵɵi18n(1, 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"mat-dialog-content\", 2);\n        i0.ɵɵelementContainerStart(3);\n        i0.ɵɵelementStart(4, \"div\");\n        i0.ɵɵi18n(5, 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\");\n        i0.ɵɵelementStart(7, \"form\", 4);\n        i0.ɵɵelementStart(8, \"kd-help-section\");\n        i0.ɵɵelementStart(9, \"mat-form-field\");\n        i0.ɵɵelement(10, \"input\", 5);\n        i0.ɵɵelementStart(11, \"mat-hint\", 6);\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(13, CreateSecretDialog_mat_error_13_Template, 2, 0, \"mat-error\", 7);\n        i0.ɵɵtemplate(14, CreateSecretDialog_mat_error_14_Template, 2, 1, \"mat-error\", 7);\n        i0.ɵɵtemplate(15, CreateSecretDialog_mat_error_15_Template, 2, 0, \"mat-error\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"kd-user-help\");\n        i0.ɵɵelementStart(17, \"span\");\n        i0.ɵɵi18n(18, 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"a\", 9);\n        i0.ɵɵi18nStart(20, 10);\n        i0.ɵɵelement(21, \"i\", 11);\n        i0.ɵɵi18nEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"kd-help-section\");\n        i0.ɵɵelementStart(23, \"mat-form-field\");\n        i0.ɵɵelement(24, \"input\", 12);\n        i0.ɵɵtemplate(25, CreateSecretDialog_mat_error_25_Template, 2, 0, \"mat-error\", 7);\n        i0.ɵɵtemplate(26, CreateSecretDialog_mat_error_26_Template, 2, 0, \"mat-error\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"kd-user-help\");\n        i0.ɵɵelementContainerStart(28);\n        i0.ɵɵi18n(29, 13);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementStart(30, \"a\", 14);\n        i0.ɵɵi18nStart(31, 15);\n        i0.ɵɵelement(32, \"i\", 11);\n        i0.ɵɵi18nEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"mat-dialog-actions\", 6);\n        i0.ɵɵelementContainerStart(34);\n        i0.ɵɵelementStart(35, \"button\", 16);\n        i0.ɵɵlistener(\"click\", function CreateSecretDialog_Template_button_click_35_listener() {\n          return ctx.createSecret();\n        });\n        i0.ɵɵi18n(36, 17);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function CreateSecretDialog_Template_button_click_37_listener() {\n          return ctx.cancel();\n        });\n        i0.ɵɵi18n(38, 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"formGroup\", ctx.form);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate2(\"\", ctx.secretName.value.length, \" / \", ctx.secretNameMaxLength, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.secretName.errors == null ? null : ctx.secretName.errors.required);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.secretName.errors == null ? null : ctx.secretName.errors.maxlength);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.secretName.errors == null ? null : ctx.secretName.errors.pattern);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.data.errors == null ? null : ctx.data.errors.required);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.data.errors == null ? null : ctx.data.errors.pattern);\n      }\n    },\n    directives: [i1.MatDialogTitle, i1.MatDialogContent, i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.FormGroupDirective, i5.HelpSectionComponent, i6.MatFormField, i7.MatInput, i4.DefaultValueAccessor, i4.NgControlStatus, i4.FormControlName, i4.RequiredValidator, i6.MatHint, i8.NgIf, i6.MatError, i9.UserHelpComponent, i1.MatDialogActions, i10.MatButton],\n    encapsulation: 2\n  });\n  return CreateSecretDialog;\n})();","map":null,"metadata":{},"sourceType":"module"}